<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phasmophobia Ghost Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #0a0a0a;
            color: #e0e0e0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
            line-height: 1.6;
            position: relative;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        /* Floating ghost orb animation */
        .ghost-orb {
            position: fixed;
            top: 10%;
            right: 5%;
            width: 30px;
            height: 30px;
            background: radial-gradient(circle, #00ff88, transparent);
            border-radius: 50%;
            opacity: 0.6;
            animation: floatOrb 8s ease-in-out infinite;
            pointer-events: none;
            z-index: 0;
        }

        @keyframes floatOrb {
            0%, 100% { transform: translate(0, 0); }
            25% { transform: translate(-30px, -50px); }
            50% { transform: translate(20px, -80px); }
            75% { transform: translate(-40px, -40px); }
        }

        /* Flash overlay for easter egg */
        .flash-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(157, 78, 221, 0.5);
            opacity: 0;
            pointer-events: none;
            z-index: 9999;
        }

        .flash-overlay.active {
            animation: flashScreen 2s ease-out;
        }

        @keyframes flashScreen {
            0%, 100% { opacity: 0; }
            10% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        /* Ghost silhouette for easter egg */
        .ghost-silhouette {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 200px;
            opacity: 0;
            pointer-events: none;
            z-index: 10000;
            filter: drop-shadow(0 0 30px rgba(157, 78, 221, 1));
        }

        .ghost-silhouette.active {
            animation: ghostAppear 2s ease-out;
        }

        @keyframes ghostAppear {
            0%, 100% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            10% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
            50% { opacity: 0.9; transform: translate(-50%, -50%) scale(1); }
        }

        /* Evidence click effects */
        .evidence-effect {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            height: 100%;
            border-radius: 5px;
            pointer-events: none;
            opacity: 0;
        }

        .evidence-effect.emf5 {
            background: radial-gradient(circle, rgba(0, 255, 136, 0.4), transparent);
        }

        .evidence-effect.freezing {
            background: radial-gradient(circle, rgba(0, 200, 255, 0.4), transparent);
        }

        .evidence-effect.spiritbox {
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                rgba(255, 255, 255, 0.3) 2px,
                rgba(255, 255, 255, 0.3) 4px
            );
        }

        .evidence-effect.uv {
            background: radial-gradient(circle, rgba(157, 78, 221, 0.4), transparent);
        }

        .evidence-effect.dots {
            background: radial-gradient(circle, rgba(0, 255, 0, 0.3), transparent);
        }

        .evidence-effect.orbs {
            background: radial-gradient(circle, rgba(0, 255, 136, 0.3), transparent);
        }

        .evidence-effect.writing {
            background: radial-gradient(circle, rgba(255, 200, 50, 0.3), transparent);
        }

        .evidence-effect.active {
            animation: evidencePulse 0.5s ease-out;
        }

        @keyframes evidencePulse {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            50% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(1); }
        }

        h1 {
            text-align: center;
            color: #00ff88;
            text-shadow: 0 0 10px #00ff88;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #9d4edd;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 968px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

        .evidence-section, .map-section, .results-section {
            background: #1a1a1a;
            border: 2px solid #00ff88;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
            position: relative;
        }

        .map-section {
            border-color: #9d4edd;
            box-shadow: 0 0 20px rgba(157, 78, 221, 0.3);
            margin-top: 0;
        }

        .results-section {
            border-color: #9d4edd;
            box-shadow: 0 0 20px rgba(157, 78, 221, 0.3);
        }

        .evidence-section h2, .map-section h2, .results-section h2 {
            color: #00ff88;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .map-section h2, .results-section h2 {
            color: #9d4edd;
        }

        .instructions {
            color: #888;
            margin-bottom: 20px;
            font-size: 0.9em;
            text-align: center;
        }

        .evidence-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
        }

        .evidence-item {
            background: #0f0f0f;
            border: 1px solid #333;
            border-radius: 5px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            user-select: none;
            position: relative;
            overflow: hidden;
        }

        .evidence-item:hover {
            border-color: #00ff88;
            box-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
        }

        .evidence-item.found {
            background: #1a3a2a;
            border-color: #00ff88;
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.6);
        }

        .evidence-item.ruled-out {
            background: #3a1a1a;
            border-color: #ff6666;
            box-shadow: 0 0 15px rgba(255, 102, 102, 0.6);
            opacity: 0.7;
        }

        .evidence-item.ruled-out .evidence-label {
            text-decoration: line-through;
            color: #ff6666;
        }

        .evidence-checkbox {
            margin-right: 10px;
            width: 18px;
            height: 18px;
            pointer-events: none;
        }

        .evidence-label {
            flex: 1;
            font-size: 1em;
        }

        .evidence-item.found .evidence-label::after {
            content: " ‚úì";
            color: #00ff88;
            margin-left: 5px;
        }

        .evidence-item.ruled-out .evidence-label::after {
            content: " ‚ùå";
            margin-left: 5px;
        }

        .mimic-warning {
            background: rgba(157, 78, 221, 0.2);
            border: 2px solid #9d4edd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            color: #9d4edd;
            font-weight: bold;
            display: none;
        }

        .mimic-warning.show {
            display: block;
            animation: warningPulse 2s ease-in-out infinite;
        }

        @keyframes warningPulse {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; box-shadow: 0 0 30px rgba(157, 78, 221, 0.6); }
        }

        #resultsCount {
            color: #888;
            font-size: 0.9em;
            margin-bottom: 15px;
            text-align: center;
        }

        .ghost-card {
            background: #0f0f0f;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .ghost-card:hover {
            border-color: #9d4edd;
            box-shadow: 0 0 15px rgba(157, 78, 221, 0.4);
        }

        .ghost-card.identified {
            border: 2px solid #00ff88;
            box-shadow: 0 0 25px rgba(0, 255, 136, 0.6);
            animation: identifiedPulse 2s ease-in-out;
        }

        @keyframes identifiedPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .identified-banner {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.2), rgba(157, 78, 221, 0.2));
            border: 2px solid #00ff88;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
            animation: bannerGlow 2s ease-in-out infinite;
        }

        @keyframes bannerGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(0, 255, 136, 0.4); }
            50% { box-shadow: 0 0 40px rgba(0, 255, 136, 0.8); }
        }

        .identified-text {
            font-size: 1.8em;
            font-weight: bold;
            color: #00ff88;
            text-shadow: 0 0 15px #00ff88;
            margin-bottom: 10px;
        }

        .identified-subtext {
            font-size: 1.3em;
            color: #9d4edd;
        }

        .ghost-name {
            font-size: 1.5em;
            font-weight: bold;
            color: #00ff88;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .danger-icon {
            font-size: 1.2em;
            animation: dangerBlink 1.5s ease-in-out infinite;
        }

        @keyframes dangerBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        .ghost-evidence {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }

        .evidence-badge {
            background: linear-gradient(135deg, #1a3a2a, #0f2419);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85em;
            color: #888;
            border: 1px solid #333;
        }

        .evidence-badge.found-evidence {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.3), rgba(0, 200, 100, 0.2));
            color: #00ff88;
            border: 1px solid #00ff88;
            box-shadow: 0 0 10px rgba(0, 255, 136, 0.4);
        }

        .evidence-badge.forced-evidence {
            background: linear-gradient(135deg, rgba(255, 165, 0, 0.3), rgba(200, 130, 0, 0.2));
            color: #ffa500;
            border: 1px solid #ffa500;
            box-shadow: 0 0 10px rgba(255, 165, 0, 0.4);
        }

        .ghost-details {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #222;
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            color: #888;
            font-weight: bold;
        }

        .detail-value {
            color: #e0e0e0;
            text-align: right;
            max-width: 60%;
        }

        .speed-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 0.75em;
            font-weight: bold;
            margin-left: 8px;
        }

        .speed-badge.speed-slow {
            background: #2a5a2a;
            color: #7fff7f;
        }

        .speed-badge.speed-normal {
            background: #4a4a2a;
            color: #ffff7f;
        }

        .speed-badge.speed-fast {
            background: #5a2a2a;
            color: #ff7f7f;
        }

        .speed-badge.speed-variable {
            background: #4a2a5a;
            color: #ff7fff;
        }

        .no-results {
            text-align: center;
            color: #888;
            padding: 40px 20px;
            font-style: italic;
        }

        .reset-button {
            background: #ff6666;
            color: #fff;
            border: 2px solid #ff6666;
            padding: 10px 25px;
            border-radius: 5px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 20px auto 0;
        }

        .reset-button:hover {
            background: #ff4444;
            border-color: #ff4444;
            box-shadow: 0 0 15px rgba(255, 102, 102, 0.4);
        }

        .map-select {
            width: 100%;
            padding: 12px;
            background: #0f0f0f;
            color: #e0e0e0;
            border: 1px solid #333;
            border-radius: 5px;
            font-size: 1em;
            margin-bottom: 20px;
            cursor: pointer;
        }

        .map-select:hover, .map-select:focus {
            border-color: #9d4edd;
            outline: none;
        }

        .cursed-objects-list {
            display: grid;
            gap: 10px;
        }

        .cursed-object-item {
            background: #0f0f0f;
            border: 1px solid #333;
            border-radius: 5px;
            padding: 12px;
            transition: all 0.3s ease;
            cursor: pointer;
            user-select: none;
        }

        .cursed-object-item:hover {
            border-color: #9d4edd;
            box-shadow: 0 0 10px rgba(157, 78, 221, 0.4);
        }

        .cursed-object-item.selected {
            border-color: #00ff88;
            background: rgba(0, 255, 136, 0.1);
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.5);
        }

        .cursed-object-item.grayed {
            opacity: 0.3;
            pointer-events: none;
        }

        .cursed-object-name {
            color: #9d4edd;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .cursed-object-location {
            color: #888;
            font-size: 0.9em;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #333;
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="ghost-orb"></div>
    <div class="flash-overlay" id="flashOverlay"></div>
    <div class="ghost-silhouette" id="ghostSilhouette">üëª</div>

    <div class="container">
        <h1>üëª Phasmophobia Ghost Tracker</h1>
        <p class="subtitle">Select evidence to identify the ghost</p>

        <div class="main-grid">
            <div class="evidence-section">
                <h2>Evidence Found</h2>
                <p class="instructions">Click once: ‚úì Found | Click twice: ‚ùå Ruled out | Click third time: Clear</p>
                
                <div id="mimicWarning" class="mimic-warning">
                    ‚ö†Ô∏è MIMIC ALERT: Ghost Orbs detected! Could be The Mimic pretending to be another ghost!
                </div>

                <div class="evidence-grid">
                    <div class="evidence-item" data-evidence="emf5" onclick="toggleEvidence('emf5')">
                        <input type="checkbox" class="evidence-checkbox">
                        <span class="evidence-label">EMF 5</span>
                        <div class="evidence-effect emf5"></div>
                    </div>
                    <div class="evidence-item" data-evidence="spiritbox" onclick="toggleEvidence('spiritbox')">
                        <input type="checkbox" class="evidence-checkbox">
                        <span class="evidence-label">Spirit Box</span>
                        <div class="evidence-effect spiritbox"></div>
                    </div>
                    <div class="evidence-item" data-evidence="writing" onclick="toggleEvidence('writing')">
                        <input type="checkbox" class="evidence-checkbox">
                        <span class="evidence-label">Ghost Writing</span>
                        <div class="evidence-effect writing"></div>
                    </div>
                    <div class="evidence-item" data-evidence="uv" onclick="toggleEvidence('uv')">
                        <input type="checkbox" class="evidence-checkbox">
                        <span class="evidence-label">UV</span>
                        <div class="evidence-effect uv"></div>
                    </div>
                    <div class="evidence-item" data-evidence="dots" onclick="toggleEvidence('dots')">
                        <input type="checkbox" class="evidence-checkbox">
                        <span class="evidence-label">D.O.T.S.</span>
                        <div class="evidence-effect dots"></div>
                    </div>
                    <div class="evidence-item" data-evidence="orbs" onclick="toggleEvidence('orbs')">
                        <input type="checkbox" class="evidence-checkbox">
                        <span class="evidence-label">Ghost Orbs</span>
                        <div class="evidence-effect orbs"></div>
                    </div>
                    <div class="evidence-item" data-evidence="freezing" onclick="toggleEvidence('freezing')">
                        <input type="checkbox" class="evidence-checkbox">
                        <span class="evidence-label">Freezing Temps</span>
                        <div class="evidence-effect freezing"></div>
                    </div>
                </div>

                <button class="reset-button" onclick="resetAll()">Reset All Evidence</button>
            </div>

            <div class="results-section">
                <h2>Possible Ghosts</h2>
                <div id="resultsCount">Select evidence to narrow down possibilities</div>
                <div id="ghostResults">
                    <div class="no-results">Check off evidence to see possible ghosts</div>
                </div>
            </div>
        </div>

        <div class="map-section">
            <h2>üó∫Ô∏è Maps & Cursed Object Locations</h2>
            <p class="instructions">Select a map to see where cursed objects can spawn</p>
            
            <select id="mapSelect" class="map-select" onchange="updateCursedObjects()">
                <option value="">-- Select a Map --</option>
                <option value="tanglewood">Tanglewood Street House</option>
                <option value="edgefield">Edgefield Road</option>
                <option value="ridgeview">Ridgeview Court</option>
                <option value="grafton">Grafton Farmhouse</option>
                <option value="bleasdale">Bleasdale Farmhouse</option>
                <option value="brownstone">Brownstone High School</option>
                <option value="prison">Prison</option>
                <option value="asylum">Asylum</option>
                <option value="maple">Maple Lodge Campsite</option>
                <option value="woodwind">Camp Woodwind</option>
                <option value="sunny">Sunny Meadows (Restricted)</option>
                <option value="point">Point Hope</option>
            </select>

            <div id="cursedObjectsList" class="cursed-objects-list">
                <p style="color: #888; text-align: center;">Select a map to see cursed object locations</p>
            </div>
        </div>

        <footer>
            Made for ghost hunters by ghost hunters üëª | Stay safe out there!
        </footer>
    </div>

    <script>
        // Easter egg tracking
        let clickCount = 0;
        let clickTimer = null;

        // Evidence state tracking
        let evidenceStates = {
            emf5: 'none',
            spiritbox: 'none',
            writing: 'none',
            uv: 'none',
            dots: 'none',
            orbs: 'none',
            freezing: 'none'
        };

        // Track used phrases to avoid repeats
        let usedPhrases = [];

        // Ghost data with all information
        const ghosts = [
            {
                name: "Spirit",
                evidence: ["emf5", "spiritbox", "writing"],
                speed: "Normal (1.7 m/s)",
                speedCategory: "normal",
                huntThreshold: "50% sanity",
                traits: "Most common ghost type",
                behavior: "No special abilities. Smudge sticks prevent hunts for 180s.",
                dangerLevel: "low"
            },
            {
                name: "Wraith",
                evidence: ["emf5", "spiritbox", "dots"],
                speed: "Normal (1.7 m/s)",
                speedCategory: "normal",
                huntThreshold: "50% sanity",
                traits: "Can teleport to players, doesn't leave UV footprints",
                behavior: "Toxic reaction to salt. Can step in salt but won't leave footprints.",
                dangerLevel: "medium"
            },
            {
                name: "Phantom",
                evidence: ["spiritbox", "uv", "dots"],
                speed: "Normal (1.7 m/s)",
                speedCategory: "normal",
                huntThreshold: "50% sanity",
                traits: "Drains sanity faster when seen",
                behavior: "Taking a photo makes it disappear temporarily. Blinks less during hunts.",
                dangerLevel: "medium"
            },
            {
                name: "Poltergeist",
                evidence: ["spiritbox", "uv", "writing"],
                speed: "Normal (1.7 m/s)",
                speedCategory: "normal",
                huntThreshold: "50% sanity",
                traits: "Can throw multiple objects at once",
                behavior: "Very active with objects. Multi-throw drains sanity. Empty rooms = less active.",
                dangerLevel: "medium"
            },
            {
                name: "Banshee",
                evidence: ["uv", "orbs", "dots"],
                speed: "Normal (1.7 m/s)",
                speedCategory: "normal",
                huntThreshold: "50% sanity (target only)",
                traits: "Targets one player at a time",
                behavior: "Crucifixes work at 5m range. Hunts only target, but will kill anyone in path.",
                dangerLevel: "high"
            },
            {
                name: "Jinn",
                evidence: ["emf5", "uv", "freezing"],
                speed: "Fast (2.5 m/s) when far from player & breaker on",
                speedCategory: "fast",
                huntThreshold: "50% sanity",
                traits: "Breaker powers its abilities",
                behavior: "Faster when far away if breaker is on. Cannot turn off breaker.",
                dangerLevel: "medium"
            },
            {
                name: "Mare",
                evidence: ["spiritbox", "orbs", "writing"],
                speed: "Normal (1.7 m/s)",
                speedCategory: "normal",
                huntThreshold: "60% (darkness) / 40% (light)",
                traits: "Prefers darkness, hates light",
                behavior: "More likely to turn off lights. Hunt threshold changes with light level.",
                dangerLevel: "medium"
            },
            {
                name: "Revenant",
                evidence: ["orbs", "writing", "freezing"],
                speed: "Slow (1.0 m/s) ‚Üí Very Fast (3.0 m/s) when chasing",
                speedCategory: "variable",
                huntThreshold: "50% sanity",
                traits: "Extremely fast when it sees you",
                behavior: "Slow when wandering, extremely fast when chasing. Break line of sight!",
                dangerLevel: "extreme"
            },
            {
                name: "Shade",
                evidence: ["emf5", "writing", "freezing"],
                speed: "Normal (1.7 m/s)",
                speedCategory: "normal",
                huntThreshold: "35% sanity",
                traits: "Shy, less likely to hunt in groups",
                behavior: "Won't hunt if players are grouped. Very low activity when players nearby.",
                dangerLevel: "low"
            },
            {
                name: "Demon",
                evidence: ["uv", "writing", "freezing"],
                speed: "Normal (1.7 m/s)",
                speedCategory: "normal",
                huntThreshold: "70% sanity",
                traits: "Most aggressive ghost, hunts early",
                behavior: "Can hunt at any sanity. Crucifixes only work at 3m. Smudge = 60s protection.",
                dangerLevel: "extreme"
            },
            {
                name: "Yurei",
                evidence: ["orbs", "freezing", "dots"],
                speed: "Normal (1.7 m/s)",
                speedCategory: "normal",
                huntThreshold: "50% sanity",
                traits: "Drains sanity faster",
                behavior: "Closes doors and drains sanity. Smudge confines it to room for 90s.",
                dangerLevel: "medium"
            },
            {
                name: "Oni",
                evidence: ["emf5", "freezing", "dots"],
                speed: "Normal (1.7 m/s)",
                speedCategory: "normal",
                huntThreshold: "50% sanity",
                traits: "Very active, visible more often",
                behavior: "More visible. Cannot do airball event. More active when people nearby.",
                dangerLevel: "medium"
            },
            {
                name: "Yokai",
                evidence: ["spiritbox", "orbs", "dots"],
                speed: "Normal (1.7 m/s)",
                speedCategory: "normal",
                huntThreshold: "80% sanity (if talking nearby) / 50% (normal)",
                traits: "Triggered by voice",
                behavior: "Voice activates it more. Can only hear electronics/voices within 2m during hunt.",
                dangerLevel: "medium"
            },
            {
                name: "Hantu",
                evidence: ["uv", "orbs", "freezing"],
                forcedEvidence: ["freezing"],
                speed: "Slow (1.4 m/s) in warm ‚Üí Fast (2.7 m/s) in cold",
                speedCategory: "variable",
                huntThreshold: "50% sanity",
                traits: "Cold-based speed, visible breath during hunts",
                behavior: "Faster in cold areas. Keep breaker ON to slow it. Visible freezing breath.",
                dangerLevel: "high"
            },
            {
                name: "Goryo",
                evidence: ["emf5", "uv", "dots"],
                forcedEvidence: ["dots"],
                speed: "Normal (1.7 m/s)",
                speedCategory: "normal",
                huntThreshold: "50% sanity",
                traits: "D.O.T.S. only visible on camera",
                behavior: "Cannot roam far from ghost room. D.O.T.S. only seen through video camera.",
                dangerLevel: "low"
            },
            {
                name: "Myling",
                evidence: ["emf5", "uv", "writing"],
                speed: "Normal (1.7 m/s)",
                speedCategory: "normal",
                huntThreshold: "50% sanity",
                traits: "Quiet footsteps during hunts",
                behavior: "Paranormal sounds more often. Footsteps/vocals only heard within 12m.",
                dangerLevel: "high"
            },
            {
                name: "Onryo",
                evidence: ["spiritbox", "orbs", "freezing"],
                speed: "Normal (1.7 m/s)",
                speedCategory: "normal",
                huntThreshold: "60% sanity",
                traits: "Fire-related behavior",
                behavior: "Blows out flames. 3rd flame blown = hunt attempt. Lit candle blocks hunt.",
                dangerLevel: "medium"
            },
            {
                name: "The Twins",
                evidence: ["emf5", "spiritbox", "freezing"],
                speed: "Slow (1.5 m/s) or Fast (1.9 m/s) depending on twin",
                speedCategory: "variable",
                huntThreshold: "50% sanity",
                traits: "Two entities, can hunt/interact separately",
                behavior: "Can be in two places at once. Speed varies. Interactions alternate.",
                dangerLevel: "high"
            },
            {
                name: "Raiju",
                evidence: ["emf5", "orbs", "dots"],
                speed: "Fast (2.5 m/s) near active electronics",
                speedCategory: "fast",
                huntThreshold: "65% sanity (electronics nearby) / 50% (normal)",
                traits: "Electronics supercharge it",
                behavior: "Faster near electronics. Disrupts equipment from farther away during hunts.",
                dangerLevel: "high"
            },
            {
                name: "Obake",
                evidence: ["emf5", "uv", "orbs"],
                forcedEvidence: ["uv"],
                speed: "Normal (1.7 m/s)",
                speedCategory: "normal",
                huntThreshold: "50% sanity",
                traits: "Shapeshifter, UV trickery",
                behavior: "6-fingered handprints (rare). UV evidence disappears faster. Changes models.",
                dangerLevel: "medium"
            },
            {
                name: "The Mimic",
                evidence: ["spiritbox", "uv", "freezing", "orbs"],
                forcedEvidence: ["orbs"],
                speed: "Copies other ghosts",
                speedCategory: "variable",
                huntThreshold: "Varies (copies target ghost)",
                traits: "Mimics other ghost types, always has Ghost Orbs",
                behavior: "Copies abilities/speed of other ghosts. ALWAYS shows Ghost Orbs as 4th evidence.",
                dangerLevel: "extreme"
            },
            {
                name: "Moroi",
                evidence: ["spiritbox", "writing", "freezing"],
                forcedEvidence: ["spiritbox"],
                speed: "Speeds up as sanity drops (1.5-2.25 m/s)",
                speedCategory: "variable",
                huntThreshold: "50% sanity",
                traits: "Curse on Spirit Box response",
                behavior: "Gets faster at lower average sanity. Sanity drains faster. Smudge blinds longer.",
                dangerLevel: "high"
            },
            {
                name: "Deogen",
                evidence: ["spiritbox", "writing", "dots"],
                forcedEvidence: ["spiritbox"],
                speed: "Fast (3.0 m/s) far away ‚Üí Slow (0.4 m/s) close",
                speedCategory: "variable",
                huntThreshold: "40% sanity",
                traits: "Always knows where you are",
                behavior: "Cannot hide from it. Slows down when close. Best strategy: loop around objects.",
                dangerLevel: "extreme"
            },
            {
                name: "Thaye",
                evidence: ["orbs", "writing", "dots"],
                speed: "Fast (2.75 m/s) when young ‚Üí Slow (1.0 m/s) when old",
                speedCategory: "variable",
                huntThreshold: "75% (young) ‚Üí 15% (old)",
                traits: "Ages over time, becoming less dangerous",
                behavior: "Very active/fast when young. Ages with player presence. Gets slower/calmer.",
                dangerLevel: "variable"
            },
            {
                name: "Dayan",
                evidence: ["emf5", "orbs", "spiritbox"],
                forcedEvidence: ["spiritbox"],
                speed: "Normal (1.7 m/s) ‚Üí Fast (2.5 m/s) when players move nearby",
                speedCategory: "variable",
                huntThreshold: "50% sanity",
                traits: "Speeds up when players move, slows when they stand still",
                behavior: "Reacts to movement within 10m. Stand still to weaken. Always uses female model/name.",
                dangerLevel: "medium"
            },
            {
                name: "Gallu",
                evidence: ["emf5", "uv", "spiritbox"],
                forcedEvidence: ["spiritbox"],
                speed: "Variable based on enraged state",
                speedCategory: "variable",
                huntThreshold: "50% (normal) / 60% (enraged)",
                traits: "Angered by protective equipment, becomes exhausted",
                behavior: "Protective equipment (crucifix/incense) enrages it, making items less effective. Gets tired after, making items more effective.",
                dangerLevel: "high"
            },
            {
                name: "Obambo",
                evidence: ["writing", "uv", "dots"],
                speed: "Slow (1.45 m/s) calm ‚Üí Fast (1.96 m/s) aggressive",
                speedCategory: "variable",
                huntThreshold: "10% (calm) / 65% (aggressive)",
                traits: "Switches states every 2 minutes between calm and aggressive",
                behavior: "Unpredictable. Calm = slow hunts at low sanity. Aggressive = early fast hunts. Can switch mid-hunt.",
                dangerLevel: "high"
            }
        ];

        // Identification phrases
        const identificationPhrases = {
            general: [
                "Oh shit, a ghost!!",
                "Great Scott!",
                "Found the bastard!",
                "There's your culprit!",
                "Ghost identified!",
                "Well, well, well... look who it is!",
                "Gotcha, you spooky son of a bitch!",
                "Mystery solved!",
                "Bingo! Ghost located!",
                "And the winner is...",
                "Pack it up, we got 'em!",
                "Case closed!",
                "Well, that's unfortunate.",
                "Congratulations! You found the murder ghost!",
                "Ding ding ding! We have a winner!",
                "Tag, you're it!",
                "Ghost located. Sanity? Not so much.",
                "Found it! Now can we leave?",
                "Achievement unlocked: Ghost Identified",
                "There's your problem right there.",
                "Yep, definitely haunted.",
                "Mystery solved, trauma acquired.",
                "And the award for scariest ghost goes to...",
                "Nailed it! ...can we go now?",
                "Welp, there's your ghost.",
                "Called it!",
                "Book 'em, boys!",
                "Case. Fucking. Closed."
            ],
            specific: {
                "Demon": [
                    "GET OUT NOW!!!",
                    "A DEMON?! RUN!!!",
                    "Oh fuck, it's a Demon! EVACUATE!",
                    "This is BAD. Very, very bad.",
                    "The power of Christ compels you! ...wait, wrong game.",
                    "Time to call an exorcist!",
                    "Call a priest. Actually, call several priests.",
                    "This is above our pay grade!",
                    "Worst case scenario achieved!",
                    "Why is it always a Demon?!"
                ],
                "Deogen": [
                    "GET OUT NOW!!!",
                    "It knows where you are! RUN!",
                    "A Deogen?! You can't hide from this one!",
                    "Hope you're good at looping...",
                    "It knows when you are sleeping, it knows when you're awake..."
                ],
                "Revenant": [
                    "Don't let it see you!",
                    "A Revenant! Break line of sight NOW!",
                    "If it sees you, you're done for!",
                    "Time to practice your hiding skills...",
                    "It'll follow you to the ends of the earth!",
                    "Run. Zig-zag. Hide. SURVIVE.",
                    "Fast AND furious!",
                    "It's MAD and it's FAST."
                ],
                "Moroi": [
                    "Hope your sanity is high...",
                    "A Moroi! It's gonna drain you fast!",
                    "Don't talk to it anymore!",
                    "Sanity pills. NOW.",
                    "Pop those sanity pills like candy!",
                    "Your mic just became a liability."
                ],
                "Thaye": [
                    "Is it old or young? That's the question...",
                    "A Thaye! Check how aged it is!",
                    "Could be fast, could be slow. Good luck!",
                    "Time to age this ghost out!",
                    "Benjamin Button: Ghost Edition"
                ],
                "Banshee": [
                    "Someone's the target... hope it's not you!",
                    "A Banshee! It's hunting someone specific!",
                    "Who's the unlucky target?",
                    "Better not be chasing YOU...",
                    "Hear that scream? Yeah, that's not good.",
                    "Someone's got a stalker...",
                    "Hope you're not the favorite!",
                    "It's personal now."
                ],
                "The Mimic": [
                    "Those fake orbs almost got you, huh?",
                    "Classic Mimic move!",
                    "The trickster reveals itself!",
                    "Can't fool us with fake evidence!",
                    "Identity theft is not a joke, Jim!",
                    "The ghost of many faces!",
                    "Congratulations, you've been bamboozled!",
                    "The orbs were a LIE!"
                ],
                "Yokai": [
                    "SHUT UP! It's a Yokai!",
                    "Stop talking! It's a Yokai!",
                    "Voice activated ghost detected!",
                    "Time to zip it!",
                    "Shhhhh! Be vewy vewy quiet...",
                    "Indoor voices, people!",
                    "Silence is golden. And mandatory.",
                    "Talk = death. Choose wisely.",
                    "Library rules are now SURVIVAL rules."
                ],
                "Oni": [
                    "At least it's visible!",
                    "An Oni! Chatty little bastard.",
                    "Super active = super annoying",
                    "This one likes to show off!",
                    "Big, visible, and ANGRY!"
                ],
                "Shade": [
                    "A shy one! Aww...",
                    "It's a Shade! No wonder it was quiet.",
                    "The antisocial ghost reveals itself!",
                    "Too shy to hunt much. Nice!",
                    "Finally, a ghost with social anxiety!",
                    "The introvert of ghosts!",
                    "Barely even hunting. Polite, honestly."
                ],
                "Phantom": [
                    "Now you see it, now you don't!",
                    "Good luck with those sanity pills!",
                    "Your sanity just said 'goodbye'."
                ],
                "Poltergeist": [
                    "Poltergeist? More like PAIN-tergeist!",
                    "Hide your stuff. All of it.",
                    "R.I.P. to every object in this house.",
                    "The throwing champion has entered the chat!"
                ],
                "Jinn": [
                    "No wishes granted here, sorry!",
                    "Unplug EVERYTHING.",
                    "Your breaker box is not your friend.",
                    "Electricity betrays us again!"
                ],
                "Mare": [
                    "Afraid of the dark? You should be.",
                    "Who turned out the lights?",
                    "Lights on = safe. Lights off = dead.",
                    "Your childhood fear was justified!",
                    "The dark is NOT your friend here."
                ],
                "Wraith": [
                    "Salt? What salt? -The Wraith, probably",
                    "Footprint-free and loving it!",
                    "This one flies coach."
                ],
                "Spirit": [
                    "The most average ghost alive. Well, dead.",
                    "Congrats, it's a boy! ...I mean Spirit.",
                    "Could be worse. Could be a Demon.",
                    "Don't let the name fool you - still deadly.",
                    "Basic doesn't mean harmless.",
                    "The 'normal' ghost that keeps killing people.",
                    "Underestimate it at your own risk.",
                    "It's common for a reason - it WORKS.",
                    "Plain vanilla with a side of murder."
                ],
                "Yurei": [
                    "*SLAM* goes another door...",
                    "It REALLY hates open doors."
                ],
                "Hantu": [
                    "Let it go, let it go... wait, wrong ice reference.",
                    "Colder than your ex's heart!",
                    "Turn the heat OFF? Are you INSANE?",
                    "Breaker stays ON for this one!"
                ],
                "Goryo": [
                    "Camera shy? Nope, just exclusive to cameras!",
                    "Smile for the camera... or don't. We can't see you anyway.",
                    "Congrats on buying a video camera!",
                    "DOTS + Video Camera = your new best friend"
                ],
                "Myling": [
                    "Quiet footsteps, loud consequences!",
                    "The sneaky little shit!"
                ],
                "Onryo": [
                    "Don't worry, it won't crawl out of your TV... probably.",
                    "Hear that death rattle? Time to leave.",
                    "Blow out the candles, win a hunt!",
                    "Fire bad. Ghost mad.",
                    "Candles: your new religion.",
                    "Fire management simulator activated!"
                ],
                "The Twins": [
                    "Here's Johnny!",
                    "All work and no play makes ghost hunters go crazy.",
                    "Come play with us... forever and ever...",
                    "Double trouble!",
                    "Seeing double? That's not the sanity drain...",
                    "Two for the price of one. Lucky you!",
                    "Parent Trap, but make it deadly.",
                    "Tag-team terror!"
                ],
                "Raiju": [
                    "Someone forgot to turn off their flashlight...",
                    "Flashlights OFF, people!",
                    "Electronics = rocket fuel for murder."
                ],
                "Obake": [
                    "Six fingers? Someone's been to Chernobyl...",
                    "The shapeshifting sneakster!",
                    "Count those fingers carefully...",
                    "Fingerprint roulette!"
                ],
                "Dayan": [
                    "Stand still and she slows down!",
                    "The dancing ghost reveals itself!",
                    "Movement = speed. Keep that in mind.",
                    "Watching your every move...",
                    "Stop moving or you're done for!"
                ],
                "Gallu": [
                    "Another demon? Just what we needed!",
                    "Stop using that crucifix, you're making it angry!",
                    "Protective equipment makes it STRONGER? Great.",
                    "Wait for it to get tired, then strike!",
                    "The enraged demon shows itself!"
                ],
                "Obambo": [
                    "Mood swings: The Ghost!",
                    "Is it calm or aggressive? Good luck!",
                    "The two-faced spirit reveals itself!",
                    "It just switched states mid-hunt. Fun.",
                    "Bipolar ghost energy right here."
                ]
            }
        };

        // Cursed object data
        const cursedObjectData = {
            tanglewood: [
                { name: "Summoning Circle", location: "Garage" },
                { name: "Ouija Board", location: "Basement or Master Bedroom" },
                { name: "Music Box", location: "Living Room or Boys Bedroom" },
                { name: "Voodoo Doll", location: "Storage Room" },
                { name: "Tarot Cards", location: "Living Room (small table in corner)" },
                { name: "Haunted Mirror", location: "Hallway near Living Room (on wall)" }
            ],
            edgefield: [
                { name: "Summoning Circle", location: "Basement (near stairs)" },
                { name: "Ouija Board", location: "Basement backroom (on shelf)" },
                { name: "Music Box", location: "Foyer (near stairs)" },
                { name: "Voodoo Doll", location: "Purple bedroom (2nd floor)" },
                { name: "Tarot Cards", location: "Table behind front door" },
                { name: "Haunted Mirror", location: "Living Room (southwest corner)" }
            ],
            ridgeview: [
                { name: "Summoning Circle", location: "Garage" },
                { name: "Ouija Board", location: "1st floor utility closet" },
                { name: "Music Box", location: "Girl's bedroom" },
                { name: "Voodoo Doll", location: "Office" },
                { name: "Tarot Cards", location: "Foyer (near window by front door)" },
                { name: "Haunted Mirror", location: "Behind stairs (1st floor)" }
            ],
            grafton: [
                { name: "Summoning Circle", location: "Shed" },
                { name: "Ouija Board", location: "Master bedroom closet" },
                { name: "Music Box", location: "Dining Room" },
                { name: "Voodoo Doll", location: "Nursery (2nd floor)" },
                { name: "Tarot Cards", location: "Dining table (left of front door)" },
                { name: "Haunted Mirror", location: "Living Room (multiple spots)" }
            ],
            bleasdale: [
                { name: "Summoning Circle", location: "Attic" },
                { name: "Ouija Board", location: "Workshop" },
                { name: "Music Box", location: "Nursery (2nd floor)" },
                { name: "Voodoo Doll", location: "Laundry Room" },
                { name: "Tarot Cards", location: "Office (1st room on left, on desk)" },
                { name: "Haunted Mirror", location: "Living Room or Office (multiple spots)" }
            ],
            brownstone: [
                { name: "Summoning Circle", location: "Lobby (between lobby and corridor)" },
                { name: "Ouija Board", location: "Lobby area (1st floor)" },
                { name: "Music Box", location: "Lobby (past mirror)" },
                { name: "Voodoo Doll", location: "Pool Area or Gym" },
                { name: "Tarot Cards", location: "Lobby (near 1st classroom wall)" },
                { name: "Haunted Mirror", location: "Lobby (along library wall)" }
            ],
            prison: [
                { name: "Summoning Circle", location: "Main entrance area" },
                { name: "Ouija Board", location: "Main entrance (left corner)" },
                { name: "Music Box", location: "Near entrance" },
                { name: "Voodoo Doll", location: "Cafeteria area" },
                { name: "Tarot Cards", location: "Box near entrance (left side)" },
                { name: "Haunted Mirror", location: "Under seats (right of 1st aisle)" }
            ],
            asylum: [
                { name: "Summoning Circle", location: "Chapel (on stage)" },
                { name: "Ouija Board", location: "Chapel (on stage)" },
                { name: "Music Box", location: "Chapel (on stage)" },
                { name: "Voodoo Doll", location: "Chapel (on stage)" },
                { name: "Tarot Cards", location: "Chapel (on stage)" },
                { name: "Haunted Mirror", location: "Chapel (on stage)" }
            ],
            maple: [
                { name: "Summoning Circle", location: "Cabin (base of stairs - 1st floor)" },
                { name: "Ouija Board", location: "Restroom building (back alley shelf)" },
                { name: "Music Box", location: "Campfire by totem pole (on stump)" },
                { name: "Voodoo Doll", location: "Left campsite (logs around campfire)" },
                { name: "Tarot Cards", location: "Table behind campfire (left after spawn)" },
                { name: "Haunted Mirror", location: "Reception building (above couch, left side)" }
            ],
            woodwind: [
                { name: "Summoning Circle", location: "Campfire area" },
                { name: "Ouija Board", location: "Cabin interiors" },
                { name: "Music Box", location: "Main lodge area" },
                { name: "Voodoo Doll", location: "Storage shed or campfire logs" },
                { name: "Tarot Cards", location: "Wooden tables (left side, on back)" },
                { name: "Haunted Mirror", location: "Left of campfire (by tree w/ fairy lights)" }
            ],
            sunny: [
                { name: "Summoning Circle", location: "Chapel (on stage in circle)" },
                { name: "Ouija Board", location: "Chapel (on stage)" },
                { name: "Music Box", location: "Chapel (on stage)" },
                { name: "Voodoo Doll", location: "Chapel (on stage)" },
                { name: "Tarot Cards", location: "Chapel (on stage)" },
                { name: "Haunted Mirror", location: "Chapel (on stage)" }
            ],
            point: [
                { name: "Summoning Circle", location: "5th floor bathroom (center)" },
                { name: "Ouija Board", location: "4th floor (on shelf, middle of room)" },
                { name: "Music Box", location: "2nd floor" },
                { name: "Voodoo Doll", location: "Varies by floor" },
                { name: "Tarot Cards", location: "1st floor (end table between green couches)" },
                { name: "Haunted Mirror", location: "3rd floor (by blue cabinet)" }
            ]
        };

        // Tab switching
        function switchTab(tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-button');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            buttons.forEach(btn => btn.classList.remove('active'));
            
            if (tabName === 'evidence') {
                document.getElementById('evidenceTab').classList.add('active');
                buttons[0].classList.add('active');
            } else {
                document.getElementById('mapTab').classList.add('active');
                buttons[1].classList.add('active');
            }
        }

        // Evidence toggle with effects
        function toggleEvidence(evidenceId) {
            const item = document.querySelector(`.evidence-item[data-evidence="${evidenceId}"]`);
            const checkbox = item.querySelector('.evidence-checkbox');
            const effect = item.querySelector('.evidence-effect');
            
            // Easter egg tracking
            clickCount++;
            if (clickTimer) clearTimeout(clickTimer);
            clickTimer = setTimeout(() => { clickCount = 0; }, 2000);
            
            if (clickCount >= 15) {
                triggerEasterEgg();
                clickCount = 0;
            }

            // Trigger visual effect only when marking as "found"
            if (evidenceStates[evidenceId] === 'none') {
                effect.classList.add('active');
                setTimeout(() => effect.classList.remove('active'), 500);
            }

            // Cycle through states: none ‚Üí found ‚Üí ruled-out ‚Üí none
            if (evidenceStates[evidenceId] === 'none') {
                evidenceStates[evidenceId] = 'found';
                item.classList.add('found');
                checkbox.checked = true;
            } else if (evidenceStates[evidenceId] === 'found') {
                evidenceStates[evidenceId] = 'ruled-out';
                item.classList.remove('found');
                item.classList.add('ruled-out');
                checkbox.checked = false;
                checkbox.indeterminate = true;
            } else {
                evidenceStates[evidenceId] = 'none';
                item.classList.remove('ruled-out');
                checkbox.checked = false;
                checkbox.indeterminate = false;
            }

            updateMimicWarning();
            filterGhosts();
        }

        function triggerEasterEgg() {
            const overlay = document.getElementById('flashOverlay');
            const ghost = document.getElementById('ghostSilhouette');
            
            overlay.classList.add('active');
            ghost.classList.add('active');
            
            setTimeout(() => {
                overlay.classList.remove('active');
                ghost.classList.remove('active');
            }, 2000);
        }

        function updateMimicWarning() {
            const warning = document.getElementById('mimicWarning');
            if (evidenceStates.orbs === 'found') {
                const foundEvidence = Object.keys(evidenceStates).filter(ev => evidenceStates[ev] === 'found');
                const ruledOutEvidence = Object.keys(evidenceStates).filter(ev => evidenceStates[ev] === 'ruled-out');
                
                const mimicRealEvidence = ["spiritbox", "freezing", "uv"];
                const nonOrbsFound = foundEvidence.filter(e => e !== "orbs");
                const mimicPossible = nonOrbsFound.every(ev => mimicRealEvidence.includes(ev)) &&
                                     !ruledOutEvidence.some(ev => mimicRealEvidence.includes(ev));
                
                if (mimicPossible) {
                    warning.classList.add('show');
                } else {
                    warning.classList.remove('show');
                }
            } else {
                warning.classList.remove('show');
            }
        }

        function getIdentificationPhrase(ghostName) {
            let phrases;
            
            if (identificationPhrases.specific[ghostName]) {
                phrases = identificationPhrases.specific[ghostName];
            } else {
                phrases = identificationPhrases.general;
            }

            let availablePhrases = phrases.filter(p => !usedPhrases.includes(p));
            
            if (availablePhrases.length === 0) {
                usedPhrases = [];
                availablePhrases = phrases;
            }

            const phrase = availablePhrases[Math.floor(Math.random() * availablePhrases.length)];
            usedPhrases.push(phrase);
            if (usedPhrases.length > 5) {
                usedPhrases.shift();
            }

            return phrase;
        }

        function filterGhosts() {
            const resultsDiv = document.getElementById('ghostResults');
            const resultsCount = document.getElementById('resultsCount');

            const foundEvidence = Object.keys(evidenceStates).filter(ev => evidenceStates[ev] === 'found');
            const ruledOutEvidence = Object.keys(evidenceStates).filter(ev => evidenceStates[ev] === 'ruled-out');

            if (foundEvidence.length === 0 && ruledOutEvidence.length === 0) {
                resultsCount.textContent = 'Select evidence to narrow down possibilities';
                resultsDiv.innerHTML = '<div class="no-results">Check off evidence to see possible ghosts</div>';
                return;
            }

            const matchingGhosts = ghosts.filter(ghost => {
                if (ghost.name === "The Mimic") {
                    const realEvidence = ghost.evidence.filter(e => e !== "orbs");
                    
                    if (evidenceStates.orbs === 'ruled-out') {
                        return false;
                    }
                    
                    const nonOrbsFound = foundEvidence.filter(e => e !== "orbs");
                    const hasAllFound = nonOrbsFound.every(ev => realEvidence.includes(ev));
                    const hasNoRuledOut = !ruledOutEvidence.some(ev => realEvidence.includes(ev));
                    return hasAllFound && hasNoRuledOut;
                }

                const hasAllFound = foundEvidence.every(ev => ghost.evidence.includes(ev));
                const hasNoRuledOut = !ruledOutEvidence.some(ev => ghost.evidence.includes(ev));
                return hasAllFound && hasNoRuledOut;
            });

            if (matchingGhosts.length === 0) {
                resultsCount.innerHTML = '<span style="color: #ff6666;">No matches found - check your evidence or consider The Mimic</span>';
                resultsDiv.innerHTML = '<div class="no-results">No ghosts match this evidence combination. Double-check your findings!</div>';
                return;
            }

            resultsCount.textContent = `${matchingGhosts.length} possible ghost${matchingGhosts.length === 1 ? '' : 's'}`;

            if (matchingGhosts.length === 1) {
                const ghost = matchingGhosts[0];
                const phrase = getIdentificationPhrase(ghost.name);
                resultsDiv.innerHTML = createIdentifiedGhostHTML(ghost, phrase);
            } else {
                resultsDiv.innerHTML = matchingGhosts.map(ghost => createGhostCardHTML(ghost, false)).join('');
            }
        }

        function createIdentifiedGhostHTML(ghost, phrase) {
            const article = (ghost.name === "The Twins" || ghost.name === "The Mimic") ? "" : "a ";
            return `
                <div class="identified-banner">
                    <div class="identified-text">${phrase}</div>
                    <div class="identified-subtext">It's ${article}${ghost.name}!</div>
                </div>
                ${createGhostCardHTML(ghost, true)}
            `;
        }

        function createGhostCardHTML(ghost, isIdentified) {
            const evidenceLabels = {
                emf5: "EMF 5",
                spiritbox: "Spirit Box",
                writing: "Ghost Writing",
                uv: "UV",
                dots: "D.O.T.S.",
                orbs: "Ghost Orbs",
                freezing: "Freezing Temps"
            };

            const foundEvidence = Object.keys(evidenceStates).filter(ev => evidenceStates[ev] === 'found');

            const evidenceBadges = ghost.evidence.map(ev => {
                const isForced = ghost.forcedEvidence && ghost.forcedEvidence.includes(ev);
                const isFound = foundEvidence.includes(ev);
                let badgeClass = 'evidence-badge';
                if (isForced) badgeClass += ' forced-evidence';
                // Invert logic: if NOT found, highlight it (since it's still possible)
                if (!isFound) badgeClass += ' found-evidence';
                return `<span class="${badgeClass}">${evidenceLabels[ev]}${isForced ? ' ‚≠ê' : ''}</span>`;
            }).join('');

            const dangerIcon = (ghost.dangerLevel === 'extreme' || ghost.dangerLevel === 'high') 
                ? '<span class="danger-icon">‚ò†Ô∏è</span>' 
                : '';

            return `
                <div class="ghost-card ${isIdentified ? 'identified' : ''}">
                    <div class="ghost-name">${ghost.name} ${dangerIcon}</div>
                    <div class="ghost-evidence">${evidenceBadges}</div>
                    <div class="ghost-details">
                        <div class="detail-row">
                            <span class="detail-label">Speed:</span>
                            <span class="detail-value">
                                ${ghost.speed}
                                <span class="speed-badge speed-${ghost.speedCategory}">${ghost.speedCategory.toUpperCase()}</span>
                            </span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Hunt Threshold:</span>
                            <span class="detail-value">${ghost.huntThreshold}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Key Traits:</span>
                            <span class="detail-value">${ghost.traits}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Behavior:</span>
                            <span class="detail-value">${ghost.behavior}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        let selectedCursedObject = null;

        function updateCursedObjects() {
            const mapSelect = document.getElementById('mapSelect');
            const objectsList = document.getElementById('cursedObjectsList');
            const selectedMap = mapSelect.value;

            // Reset selection when map changes
            selectedCursedObject = null;

            if (!selectedMap) {
                objectsList.innerHTML = '<p style="color: #888; text-align: center;">Select a map to see cursed object locations</p>';
                return;
            }

            const objects = cursedObjectData[selectedMap];
            objectsList.innerHTML = objects.map((obj, index) => `
                <div class="cursed-object-item" onclick="toggleCursedObject(${index})">
                    <div class="cursed-object-name">${obj.name}</div>
                    <div class="cursed-object-location">${obj.location}</div>
                </div>
            `).join('');
        }

        function toggleCursedObject(index) {
            const items = document.querySelectorAll('.cursed-object-item');
            
            // If clicking the already selected item, deselect it
            if (selectedCursedObject === index) {
                selectedCursedObject = null;
                items.forEach(item => {
                    item.classList.remove('selected', 'grayed');
                });
            } else {
                // Select new item and gray out others
                selectedCursedObject = index;
                items.forEach((item, i) => {
                    item.classList.remove('selected', 'grayed');
                    if (i === index) {
                        item.classList.add('selected');
                    } else {
                        item.classList.add('grayed');
                    }
                });
            }
        }

        function filterCursedObject() {
            updateCursedObjects(); // Just recall the update function which now handles filtering
        }

        function resetAll() {
            Object.keys(evidenceStates).forEach(ev => {
                evidenceStates[ev] = 'none';
            });

            document.querySelectorAll('.evidence-item').forEach(item => {
                item.classList.remove('found', 'ruled-out');
                const checkbox = item.querySelector('.evidence-checkbox');
                checkbox.checked = false;
                checkbox.indeterminate = false;
            });

            // Reset cursed object selection
            selectedCursedObject = null;
            updateCursedObjects();

            updateMimicWarning();
            filterGhosts();
        }

        // Initialize
        filterGhosts();
    </script>
</body>
</html>
